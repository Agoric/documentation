<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Zoe Contract Facet | Alpha</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/documentation/favicon-full.ico">
    <style type="text/css">
    .two-col-table td {
        width: 50%;
    }
    .two-col-table table {
        table-layout: fixed;
    }</style>
    <script src="https://www.googletagmanager.com/gtag/js?id=UA-118217811-1"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-118217811-1'); </script>
    <script>
    const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://agoric.com");
      homeEl.setAttribute("onclick", "return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://agoric.com';return false;");
      clearInterval(logoUrlChanger);
    }
   }, 1000) </script>
    <meta name="description" content="Build, deploy and operate dApps and DeFi markets.">
    <link rel="preload" href="/documentation/assets/css/0.styles.67a7e261.css" as="style"><link rel="preload" href="/documentation/assets/js/app.b94665ac.js" as="script"><link rel="preload" href="/documentation/assets/js/2.e3678fd8.js" as="script"><link rel="preload" href="/documentation/assets/js/41.2f3c677d.js" as="script"><link rel="preload" href="/documentation/assets/js/16.4354b4bb.js" as="script"><link rel="prefetch" href="/documentation/assets/js/10.56f24b0b.js"><link rel="prefetch" href="/documentation/assets/js/11.2b04b997.js"><link rel="prefetch" href="/documentation/assets/js/12.7d1f94d9.js"><link rel="prefetch" href="/documentation/assets/js/13.2a29daf8.js"><link rel="prefetch" href="/documentation/assets/js/14.fea521a4.js"><link rel="prefetch" href="/documentation/assets/js/15.48639752.js"><link rel="prefetch" href="/documentation/assets/js/17.8cfc7bee.js"><link rel="prefetch" href="/documentation/assets/js/18.b9867d76.js"><link rel="prefetch" href="/documentation/assets/js/19.84078edf.js"><link rel="prefetch" href="/documentation/assets/js/20.194f337b.js"><link rel="prefetch" href="/documentation/assets/js/21.8b24260f.js"><link rel="prefetch" href="/documentation/assets/js/22.549d976a.js"><link rel="prefetch" href="/documentation/assets/js/23.6016be82.js"><link rel="prefetch" href="/documentation/assets/js/24.83448490.js"><link rel="prefetch" href="/documentation/assets/js/25.226cebe4.js"><link rel="prefetch" href="/documentation/assets/js/26.951478cd.js"><link rel="prefetch" href="/documentation/assets/js/27.008f9bb5.js"><link rel="prefetch" href="/documentation/assets/js/28.ae1b3809.js"><link rel="prefetch" href="/documentation/assets/js/29.99446a3e.js"><link rel="prefetch" href="/documentation/assets/js/3.8373c9e5.js"><link rel="prefetch" href="/documentation/assets/js/30.b3fd313a.js"><link rel="prefetch" href="/documentation/assets/js/31.b71d34af.js"><link rel="prefetch" href="/documentation/assets/js/32.396e4f5d.js"><link rel="prefetch" href="/documentation/assets/js/33.0a63a610.js"><link rel="prefetch" href="/documentation/assets/js/34.ff5bfe3b.js"><link rel="prefetch" href="/documentation/assets/js/35.2428be8d.js"><link rel="prefetch" href="/documentation/assets/js/36.c45628bb.js"><link rel="prefetch" href="/documentation/assets/js/37.59dbdb55.js"><link rel="prefetch" href="/documentation/assets/js/38.c6818f82.js"><link rel="prefetch" href="/documentation/assets/js/39.9ab0a975.js"><link rel="prefetch" href="/documentation/assets/js/4.c5a49f3a.js"><link rel="prefetch" href="/documentation/assets/js/40.aca2bd10.js"><link rel="prefetch" href="/documentation/assets/js/42.6e353204.js"><link rel="prefetch" href="/documentation/assets/js/43.53da7846.js"><link rel="prefetch" href="/documentation/assets/js/44.798f144b.js"><link rel="prefetch" href="/documentation/assets/js/45.dedef277.js"><link rel="prefetch" href="/documentation/assets/js/46.02ca2d9c.js"><link rel="prefetch" href="/documentation/assets/js/47.a1873871.js"><link rel="prefetch" href="/documentation/assets/js/48.5020ac36.js"><link rel="prefetch" href="/documentation/assets/js/49.c4410dee.js"><link rel="prefetch" href="/documentation/assets/js/5.12c102b6.js"><link rel="prefetch" href="/documentation/assets/js/50.befdc7f3.js"><link rel="prefetch" href="/documentation/assets/js/51.85428d1a.js"><link rel="prefetch" href="/documentation/assets/js/52.577ad90f.js"><link rel="prefetch" href="/documentation/assets/js/53.be2c48e2.js"><link rel="prefetch" href="/documentation/assets/js/54.d64ecca2.js"><link rel="prefetch" href="/documentation/assets/js/55.d41ba4d5.js"><link rel="prefetch" href="/documentation/assets/js/56.79291e2c.js"><link rel="prefetch" href="/documentation/assets/js/57.5a21f6bb.js"><link rel="prefetch" href="/documentation/assets/js/6.a8719478.js"><link rel="prefetch" href="/documentation/assets/js/7.7601b9f3.js"><link rel="prefetch" href="/documentation/assets/js/8.4cfb5a71.js"><link rel="prefetch" href="/documentation/assets/js/9.ec9256ca.js">
    <link rel="stylesheet" href="/documentation/assets/css/0.styles.67a7e261.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documentation/" class="home-link router-link-active"><img src="/documentation/logo.svg" alt="Alpha" class="logo"> <span class="site-name can-hide">Alpha</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/documentation/getting-started/intro-hackathon.html" class="nav-link">
  Hackathon
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/alpha.html" class="nav-link">
  Agoric Alpha
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/wallet-api.html" class="nav-link">
  Wallet API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/documentation/distributed-programming.html" class="nav-link">
  JS Distributed Programming
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/autoswap.html" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link router-link-active">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/documentation/getting-started/intro-hackathon.html" class="nav-link">
  Hackathon
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/alpha.html" class="nav-link">
  Agoric Alpha
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/wallet-api.html" class="nav-link">
  Wallet API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/documentation/distributed-programming.html" class="nav-link">
  JS Distributed Programming
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/autoswap.html" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link router-link-active">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/documentation/getting-started/intro-zoe.html" class="sidebar-link">Zoe Introduction</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/guide/" class="sidebar-heading clickable"><span>Zoe Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/guide/contracts/" class="sidebar-heading clickable"><span>Zoe Contracts</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/api/" class="sidebar-heading clickable router-link-active open"><span>Zoe API</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/documentation/zoe/api/zoe.html" class="sidebar-link">Zoe</a></li><li><a href="/documentation/zoe/api/zoe-contract-facet.html" aria-current="page" class="active sidebar-link">Zoe Contract Facet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#start" class="sidebar-link">start</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-makezcfmint-keyword-amountmathkind" class="sidebar-link">zcf.makeZCFMint(keyword, amountMathKind)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-getinvitationissuer" class="sidebar-link">zcf.getInvitationIssuer()</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-saveissuer-issuer-keyword" class="sidebar-link">zcf.saveIssuer(issuer, keyword)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-makeinvitation-offerhandler-description-customproperties" class="sidebar-link">zcf.makeInvitation(offerHandler, description, customProperties)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-makeemptyseatkit" class="sidebar-link">zcf.makeEmptySeatKit()</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcfseat-object" class="sidebar-link">ZCFSeat object</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-getbrandforissuer-issuer" class="sidebar-link">zcf.getBrandForIssuer(issuer)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-getissuerforbrand-brand" class="sidebar-link">zcf.getIssuerForBrand(brand)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-getamountmath-brand" class="sidebar-link">zcf.getAmountMath(brand)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-stopacceptingoffers" class="sidebar-link">zcf.stopAcceptingOffers()</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-shutdown-completion" class="sidebar-link">zcf.shutdown(completion)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-getterms" class="sidebar-link">zcf.getTerms()</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-getzoeservice" class="sidebar-link">zcf.getZoeService()</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-assertuniquekeyword-keyword" class="sidebar-link">zcf.assertUniqueKeyword(keyword)</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/api/zoe-contract-facet.html#zcf-reallocate-seatstagings" class="sidebar-link">zcf.reallocate(seatStagings)</a></li></ul></li><li><a href="/documentation/zoe/api/zoe-helpers.html" class="sidebar-link">ZoeHelpers</a></li></ul></section></li><li><a href="/documentation/zoe/roadmap/" class="sidebar-link">Zoe Roadmap</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="zoe-contract-facet"><a href="#zoe-contract-facet" class="header-anchor">#</a> Zoe Contract Facet</h1> <div class="zoe-version">
    Zoe Alpha Release v0.8.1. Last updated
    2020-9-15.
</div> <p>A Zoe Contract Facet is an API object for a running contract instance to access the Zoe state
for that instance. A Zoe Contract Facet is accessed synchronously from within the contract,
and usually is referred to in code as <code>zcf</code>.</p> <p>The contract instance is launched by <code>E(zoe).startInstance()</code>, and is given access to
the <code>zcf</code> object during that launch. In the operations below, <code>instance</code> is
the handle for the running contract instance.</p> <h2 id="start"><a href="#start" class="header-anchor">#</a> start</h2> <p>This section covers the code you need to have at the start of your contract code.</p> <p>To warn if the correct return values for your contract are not being returned,
add this right before the start of your contract code. It also lets TypeScript-aware
tools (IDEs like vsCode and WebStorm) inform the developer about required parameters
and return values and warn when methods are misused.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * @type {ContractStartFn}
 */</span>
</code></pre></div><p>Your contract code must export a function <code>start</code> as a non-default export.
<code>zcf</code> is the Zoe Contract Facet and is the only argument provided to the contract</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">start</span> <span class="token operator">=</span> <span class="token parameter">zcf</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token comment">// your code here</span>
  <span class="token keyword">return</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span> creatorFacet<span class="token punctuation">,</span> creatorInvitation<span class="token punctuation">,</span> publicFacet <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">harden</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> start <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The contract must return a record with any (or none) of the following:</p> <ul><li><code>creatorFacet</code> - an object, usually with admin authority. It is only given to the entity that
calls <code>E(zoe).startInstance()</code>; i.e. the party that was the creator of the current contract <code>instance</code>.
It creates <code>invitations</code> for other parties, and takes actions that are unrelated to making offers.</li> <li><code>creatorInvitation</code> - a Zoe <code>invitation</code> only given to the entity that calls <code>E(zoe).startInstance()</code>; i.e.
the party that was the creator of the current contract <code>instance</code>.
This is usually used when a party has to make an offer first, such as escrowing the underlying good
for sale in an auction or covered call.</li> <li><code>publicFacet</code> - an object available through Zoe to anyone who knows the contract instance. Use the <code>publicFacet</code> for general queries and actions, such as getting the current price or creating public <code>invitations</code>.</li></ul> <h2 id="zcf-makezcfmint-keyword-amountmathkind"><a href="#zcf-makezcfmint-keyword-amountmathkind" class="header-anchor">#</a> zcf.makeZCFMint(keyword, amountMathKind)</h2> <ul><li><code>keyword</code> <code>{String}</code></li> <li><code>amountMathKind</code> <code>{AmountMathKind}</code> (defaults to <code>MathKind.NAT</code>)</li> <li>Returns: <code>{Promise&lt;ZCFMint&gt;}</code></li></ul> <p>Creates a synchronous Zoe mint, allowing users to mint and reallocate digital assets synchronously
instead of relying on an asynchronous ERTP <code>mint</code>.</p> <p><strong>Important</strong>: <code>ZCFMints</code> do <strong>not</strong> have the same methods as an ERTP <code>mint</code>. Do not try to use
ERTP methods on a <code>ZCFMint</code> or vice versa.</p> <p><strong>Important</strong>: On the other hand, the <code>issuer</code>, <code>brand</code>, and <code>amountMath</code> associated with a <code>zcfMint</code>
do have the same methods as their ERTP-derived counterparts. Assets created by a <code>zcfMint</code> are treated
the same as ERTP <code>mint</code>-created assets by ERTP methods.</p> <p><code>ZCFMints</code> have three methods:</p> <ul><li><code>getIssuerRecord()</code> <ul><li>Returns: <code>{IssuerRecord}</code></li> <li>Returns an <code>issuerRecord</code> containing the <code>issuer</code>, <code>brand</code>, or <code>amountMath</code> associated with the <code>zcfMint</code>.</li></ul></li> <li><code>mintGains</code> <ul><li><code>gains</code>: <code>AmountKeywordRecord</code></li> <li><code>zcfSeat</code>: <code>{ZCFSeat}</code> - optional</li> <li>Returns: <code>{ZCFSeat}</code></li> <li>All <code>amounts</code> in <code>gains</code> must be of this <code>ZCFMint</code>'s <code>brand</code>.
The <code>gains</code>' keywords are in that <code>seat</code>'s namespace.
Mint the <code>gains</code> <code>amount</code> of assets and add them to
that <code>seat</code>'s <code>allocation</code>. If a <code>seat</code> is provided,
it is returned. Otherwise a new <code>seat</code> is returned.</li> <li><code>zcfMint.mintGains({ Token: amount }, seat);</code></li></ul></li> <li><code>burnLosses</code> <ul><li><code>losses</code>: <code>AmountKeywordRecord</code></li> <li><code>zcfSeat</code> : <code>{ZCFSeat}</code></li> <li>Returns: void</li> <li>All <code>amounts</code> in <code>losses</code> must be of this <code>ZCFMint</code>'s <code>brand</code>.
The <code>losses</code>' keywords are in that <code>seat</code>'s namespace.
Subtract <code>losses</code> from that <code>seat</code>'s <code>allocation</code>, then
burn that <code>amount</code> of assets from the pooled <code>purse</code>.</li> <li><code>zcfMint.burnLosses({ Token: amount }, seat);</code></li></ul></li></ul> <p><code>AmountKeywordRecord</code> is a record in which the keys are keywords, and
the values are <code>amounts</code>. Keywords are unique identifiers per contract,
that tie together the <code>proposal</code>, <code>payments</code> to be escrowed, and <code>payouts</code>
to the user. In the below example, <code>Asset</code> and <code>Price</code> are keywords.</p> <p>Users should submit their <code>payments</code> using keywords:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> payments <span class="token operator">=</span> <span class="token punctuation">{</span> Asset<span class="token operator">:</span> quatloosPayment <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>And, users will receive their <code>payouts</code> with keywords as the keys of a <code>payout</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>quatloosPurse<span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span>payout<span class="token punctuation">.</span>Asset<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> quatloos5 <span class="token operator">=</span> quatloosAmountMath<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> quatloos9 <span class="token operator">=</span> quatloosAmountMath<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> myAmountKeywordRecord <span class="token operator">=</span>
<span class="token punctuation">{</span>
  Asset<span class="token operator">:</span> quatloos5<span class="token punctuation">,</span>
  Price<span class="token operator">:</span> quatloos9
<span class="token punctuation">}</span>
</code></pre></div><p>The following demonstrates <code>zcf.makeZCFMint</code>:</p> <p><strong>Note</strong>: The call to make the <code>ZCFMint</code> is asynchronous, but
calls to the resulting <code>ZCFMint</code> are synchronous.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mySynchronousMint <span class="token operator">=</span> <span class="token keyword">await</span> zcf<span class="token punctuation">.</span><span class="token function">makeZCFMint</span><span class="token punctuation">(</span><span class="token string">'MySyncMint'</span><span class="token punctuation">,</span> <span class="token string">'set'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> amountMath<span class="token punctuation">,</span> brand<span class="token punctuation">,</span> issuer <span class="token punctuation">}</span> <span class="token operator">=</span> mySynchronousMint<span class="token punctuation">.</span><span class="token function">getIssuerRecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mySynchronousMint<span class="token punctuation">.</span><span class="token function">mintGains</span><span class="token punctuation">(</span><span class="token punctuation">{</span> MyKeyword<span class="token operator">:</span> amount <span class="token punctuation">}</span><span class="token punctuation">,</span> seat<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-getinvitationissuer"><a href="#zcf-getinvitationissuer" class="header-anchor">#</a> zcf.getInvitationIssuer()</h2> <ul><li>Returns: <a href="/documentation/ertp/api/issuer.html"><code>{Issuer}</code></a></li></ul> <p>Zoe has a single <code>invitationIssuer</code> for the entirety of its
lifetime. This method returns the Zoe <code>InvitationIssuer</code>, which
validates user-received <code>invitations</code> to participate
in contract instances.</p> <p>&quot;All <code>invitations</code> come from this single <code>invitation</code> <code>issuer</code> and its <code>mint</code>, which
mint <code>invitations</code> and validate their <code>amounts</code>.&quot;</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> invitationIssuer <span class="token operator">=</span> <span class="token keyword">await</span> zcf<span class="token punctuation">.</span><span class="token function">getInvitationIssuer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-saveissuer-issuer-keyword"><a href="#zcf-saveissuer-issuer-keyword" class="header-anchor">#</a> zcf.saveIssuer(issuer, keyword)</h2> <ul><li><code>issuer</code> <code>{Issuer}</code></li> <li><code>keyword</code> <code>{String}</code></li> <li>Returns: <code>{Promise&lt;IssuerRecord&gt;}</code></li></ul> <p>Informs Zoe about an <code>issuer</code> and returns a promise for acknowledging
when the <code>issuer</code> is added and ready. The <code>keyword</code> is the one associated
with the new <code>issuer</code>. It returns a promise for <code>issuerRecord</code> of the new <code>issuer</code></p> <p>This saves an <code>issuer</code> in Zoe's records for this contract <code>instance</code>.
It also has saved the <code>issuer</code> information such that Zoe can handle offers involving
this <code>issuer</code> and ZCF can provide the <code>issuerRecord</code> synchronously on request.</p> <p>An <code>IssuerRecord</code> has three fields, each of which holds the namesake object
associated with the <code>issuer</code> value of the record:
<code>issuerRecord.amountMath</code>, <code>issuerRecord.brand</code>, and <code>issuerRecord.issuer</code>)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> zcf<span class="token punctuation">.</span><span class="token function">saveIssuer</span><span class="token punctuation">(</span>secondaryIssuer<span class="token punctuation">,</span> keyword<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-makeinvitation-offerhandler-description-customproperties"><a href="#zcf-makeinvitation-offerhandler-description-customproperties" class="header-anchor">#</a> zcf.makeInvitation(offerHandler, description, customProperties)</h2> <ul><li><code>offerHandler</code> <code>{ZCFSeat =&gt; Object}</code></li> <li><code>description</code> <code>{String}</code></li> <li><code>customProperties</code> <code>{Object}</code></li> <li>Returns: <a href="/documentation/ertp/api/payment.html#payment"><code>{Promise&lt;Invitation&gt;}</code></a></li></ul> <p>Make a credible Zoe <code>invitation</code> for a smart contract. Note that <code>invitations</code> are a special case
of an ERTP <code>payment</code>. They are associated with the <code>invitationIssuer</code> and its <code>mint</code>, which
validate and mint <code>invitations</code>. <code>zcf.makeInvitation()</code> serves as an interface to
the <code>invitation</code> <code>mint</code>.</p> <p>The <code>invitation</code>'s
<code>value</code> specifies:</p> <ul><li>The specific contract <code>instance</code>.</li> <li>The Zoe <code>installation</code>.</li> <li>A unique <code>handle</code></li></ul> <p>The second argument is a required <code>description</code> for the <code>invitation</code>,
and should include whatever information is needed for a potential recipient of the <code>invitation</code>
to know what they are getting in the optional <code>customProperties</code> argument, which is
put in the <code>invitation</code>'s <code>value</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> creatorInvitation <span class="token operator">=</span> zcf<span class="token punctuation">.</span><span class="token function">makeInvitation</span><span class="token punctuation">(</span>makeCallOption<span class="token punctuation">,</span> <span class="token string">'makeCallOption'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="zcf-makeemptyseatkit"><a href="#zcf-makeemptyseatkit" class="header-anchor">#</a> zcf.makeEmptySeatKit()</h2> <ul><li>Returns: <code>{ZCFSeat, Promise&lt;UserSeat&gt;}</code></li></ul> <p>Returns an empty <code>ZCFSeat</code> and a promise for a <code>UserSeat</code></p> <p>Zoe uses <code>seats</code> to represent offers, and has two seat facets (a
particular view or API of an object;
there may be multiple such APIs per object) a <code>ZCFSeat</code> and a <code>UserSeat</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> zcfSeat<span class="token operator">:</span> mySeat <span class="token punctuation">}</span> <span class="token operator">=</span> zcf<span class="token punctuation">.</span><span class="token function">makeEmptySeatKit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcfseat-object"><a href="#zcfseat-object" class="header-anchor">#</a> ZCFSeat object</h2> <p>Zoe uses <code>seats</code> to access or manipulate offers. Seats represent active
offers and let contracts and users interact with them. Zoe has two kinds
of seats. <code>ZCFSeats</code> are used within contracts and with <code>zcf</code> methods.
<code>UserSeats</code> represent offers external to Zoe and the contract.</p> <p>A <code>ZCFSeat</code> includes synchronous queries for the current state of the
associated offer, such as the amounts of assets that are currently
allocated to the offer. It also includes synchronous operations
to manipulate the offer. The queries and operations are as follows:</p> <ul><li><code>hasExited()</code> <ul><li>Returns: <code>{ Boolean }</code></li> <li>Returns <code>true</code> if the <code>seat</code> has exited, <code>false</code> if it is still active.</li></ul></li> <li><code>getNotifier()</code> <ul><li>Returns: <code>{ Notifier&lt;Allocation&gt; }</code></li> <li>Returns a <code>notifier</code> associated with the <code>seat</code>'s <code>allocation</code>. You use a <code>notifier</code>
wherever some piece of code has changing state that other code wants updates on.
This <code>notifier</code> provides updates on changing <code>allocations</code> for this <code>seat</code>, and tells
when the <code>seat</code> has been exited. For more on <code>notifiers</code>, see the <a href="/documentation/distributed-programming.html#notifiers">Distributed Programming Guide</a>.</li></ul></li> <li><code>getProposal()</code> <ul><li>Returns: <code>{ ProposalRecord }</code></li> <li>A <code>Proposal</code> is represented by a <code>ProposalRecord</code>. It is the rules
accompanying the escrow of <code>payments</code> dictating what the user expects
to get back from Zoe. It has keys <code>give</code>, <code>want</code>, and
<code>exit</code>. <code>give</code> and <code>want</code> are records with keywords as keys and
<code>amounts</code> as values. The <code>proposal</code> is a user's understanding of the
contract that they are entering when they make an offer. See
<a href="/documentation/zoe/api/zoe.html#e-zoe-offer-invitation-proposal-paymentkeywordrecord"><code>E(zoe).offer()</code></a> for full details.</li> <li>Example:<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> want<span class="token punctuation">,</span> give<span class="token punctuation">,</span> exit <span class="token punctuation">}</span> <span class="token operator">=</span> sellerSeat<span class="token punctuation">.</span><span class="token function">getProposal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li> <li><code>getAmountAllocated(keyword, brand)</code> <ul><li><p>Returns: <code>{ Amount }</code></p></li> <li><p>Returns the <code>amount</code> from the part of the <code>allocation</code> that matches the
<code>keyword</code> and <code>brand</code>. If the <code>keyword</code> is not in the <code>allocation</code>, it
returns an empty <code>amount</code> of the <code>brand</code> argument.</p> <p>This is similar to the next method, <code>getCurrentAllocation()</code>. <code>getAmountAllocated()</code>
gets the <code>allocation</code> of one keyword at a time, while <code>getCurrentAllocation()</code> returns
all the current <code>allocations</code> at once.</p></li></ul></li> <li><code>getCurrentAllocation()</code> <ul><li><p>Returns: <code>{ &lt;Allocation&gt; }</code></p></li> <li><p>An <code>Allocation</code> is an <code>AmountKeywordRecord</code> of key-value pairs where
the key is a keyword such as <code>Asset</code> or <code>Price</code> applicable to the
contract. The value is an <code>amount</code> with its <code>value</code> and <code>brand</code>.</p> <p><code>Allocations</code> represent the <code>amounts</code> to be paid out to each <code>seat</code> on exit.
Normal reasons for exiting are the user requesting to exit or the contract
explicitly choosing to close out the <code>seat</code>. The guarantees also hold if the contract
encounters an error or misbehaves. There are several methods for finding out
what <code>amount</code> a current <code>allocation</code> is.</p> <p>This is similar to the previous method, <code>getAmountAllocated()</code>. <code>getAmountAllocated()</code>
gets the <code>allocation</code> of one keyword at a time, while <code>getCurrentAllocation()</code> returns
all the current <code>allocations</code> at once.</p> <p>An <code>Allocation</code> example:</p> <ul><li><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  Asset<span class="token operator">:</span> quatloosAmountMath<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Price<span class="token operator">:</span> moolaAmountMath<span class="token punctuation">.</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul></li> <li><code>exit(completion)</code> <ul><li>Returns: <code>void</code></li> <li>Causes the <code>seat</code> to exit, concluding its existence. All <code>payouts</code>, if any,
are made, and the <code>seat</code> object can no longer interact with the contract.
The <code>completion</code> argument is usually a string, but this is not required. Its
only use is for the notification sent to the contract instance's <code>done()</code> function.
Any other still open seats or outstanding promises and the contract instance continue.</li></ul></li> <li><code>fail(msg)</code> <ul><li>Returns: <code>void</code></li> <li>The <code>seat</code> exits, displaying the optional <code>msg</code> string, if there is one, on the console.
This is equivalent to exiting, except that <code>exit</code> is successful while
<code>fail()</code> signals an error occured while processing the offer. The contract
still gets its current <code>allocation</code> and the <code>seat</code> can no longer interact with the contract.
Any other still open seats or outstanding promises and the contract instance continue.</li></ul></li> <li><code>kickOut(msg)</code> <strong>Renamed fail(msg) as of 4-OCT-2020. DO NOT USE</strong> <ul><li>Returns: <code>void</code></li> <li>The <code>seat</code> exits, displaying the optional <code>msg</code> string, if there is one, on the console.
This is equivalent to exiting, except that <code>exit</code> is for a successful transaction while
<code>kickOut()</code> aborts the transaction attempt and signals an error. The contract
still gets its current <code>allocation</code> and the <code>seat</code> can no longer interact with the contract.</li></ul></li> <li><code>stage(newAllocation)</code> <ul><li><p>Returns: <code>{ SeatStaging }</code></p></li> <li><p>A <code>seatStaging</code> is an association of a <code>seat</code> with reallocations. <code>reallocate()</code> takes
at least two <code>seatStagings</code> as arguments and does its reallocation based on them.</p> <p>You can create multiple independent <code>seatStagings</code> for a <code>seat</code>. None of them has
any effect until submitted to <code>reallocate()</code>. Each call to <code>stage()</code> starts from the
<code>seat</code>'s current <code>allocation</code> and uses the <code>newAllocation</code> as a replacement for the
current state. Any keywords not mentioned in <code>newAllocation</code> retain the
same <code>amounts</code>. All keywords mentioned in the <code>newAllocation</code> have their <code>amounts</code>
replaced with the corresponding <code>amount</code> from <code>newAllocation</code>.</p> <p>Note that ZoeHelpers <a href="/documentation/zoe/api/zoe-helpers.html#trade-zcf-left-right-lefthasexitedmsg-righthasexitedmsg"><code>trade()</code></a> and <a href="/documentation/zoe/api/zoe-helpers.html#swap-zcf-leftseat-rightseat-lefthasexitedmsg-righthasexitedmsg"><code>swap()</code></a> might
be easier to use for simple cases.</p></li></ul></li> <li><code>isOfferSafe(newAllocation)</code> <ul><li>Returns <code>{ Boolean }</code></li> <li>Takes an <code>allocation</code> as an argument and returns <code>true</code> if that <code>allocation</code>
satisfies offer safety, <code>false</code> if is doesn't. Essentially, it checks
<code>newAllocation</code> for offer safety, against the <code>seat</code>'s <code>proposal</code>.
It checks whether <code>newAllocation</code> fully satisfies
<code>proposal.give</code> (giving a refund) or whether it fully satisfies
<code>proposal.want</code>. Both can be fully satisfied. See the ZoeHelper
<a href="/documentation/zoe/api/zoe-helpers.html#satisfies-zcf-seat-update"><code>satisfies()</code></a> method for more details.</li></ul></li></ul> <h2 id="zcf-getbrandforissuer-issuer"><a href="#zcf-getbrandforissuer-issuer" class="header-anchor">#</a> zcf.getBrandForIssuer(issuer)</h2> <ul><li><code>issuer</code> <code>{Issuer}</code></li> <li>Returns: <code>{Brand}</code></li></ul> <p>Returns the <code>brand</code> associated with the <code>issuer</code>.</p> <h2 id="zcf-getissuerforbrand-brand"><a href="#zcf-getissuerforbrand-brand" class="header-anchor">#</a> zcf.getIssuerForBrand(brand)</h2> <ul><li><code>brand</code> <code>{Brand}</code></li> <li>Returns: <code>{Issuer}</code></li></ul> <p>Returns the <code>issuer</code> of the <code>brand</code> argument.</p> <h2 id="zcf-getamountmath-brand"><a href="#zcf-getamountmath-brand" class="header-anchor">#</a> zcf.getAmountMath(brand)</h2> <ul><li><code>brand</code> <code>{String}</code></li> <li>Returns: <code>{amountMath}</code></li></ul> <p>Returns the <code>amountMath</code> object associated with the <code>brand</code> argument.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> assetAmountMath <span class="token operator">=</span> zcf<span class="token punctuation">.</span><span class="token function">getAmountMath</span><span class="token punctuation">(</span>assetAmount<span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-stopacceptingoffers"><a href="#zcf-stopacceptingoffers" class="header-anchor">#</a> zcf.stopAcceptingOffers()</h2> <ul><li>The contract requests Zoe to not accept offers for this contract instance.
It can't be called from outside the contract unless the contract explicitly makes it accessible.</li></ul> <h2 id="zcf-shutdown-completion"><a href="#zcf-shutdown-completion" class="header-anchor">#</a> zcf.shutdown(completion)</h2> <p>Shuts down the entire vat and contract instance and gives payouts.</p> <p>All open <code>seats</code> associated with the current <code>instance</code> have <code>fail()</code>
called on them.</p> <p>Call when:</p> <ul><li>You want nothing more to happen in the contract, and</li> <li>You don't want to take any more offers</li></ul> <p>The <code>completion</code> argument is usually a string, but this
is not required. It is used for the notification sent to the
contract instance's <code>done()</code> function. Any still open seats or
other outstanding promises are closed with a generic 'vat terminated'
message.</p> <div class="language-js extra-class"><pre class="language-js"><code>zcf<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-getterms"><a href="#zcf-getterms" class="header-anchor">#</a> zcf.getTerms()</h2> <ul><li>Returns: <code>{Object}</code></li></ul> <p>Returns the <code>issuers</code>, <code>brands</code>, and custom <code>terms</code> the current contract <code>instance</code> was instantiated with.</p> <p>Note that there is also an <code>E(zoe).getTerms(instance)</code>. Often the choice of which to use is not which method
to use, but which of Zoe Service or ZCF you have access to. On the contract side, you more easily have access
to <code>zcf</code>, and <code>zcf</code> already knows what instance is running. So in contract code, you use <code>zcf.getTerms()</code>. From
a user side, with access to Zoe Service, you use <code>E(zoe).getTerms()</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> brands<span class="token punctuation">,</span> issuers<span class="token punctuation">,</span> terms <span class="token punctuation">}</span> <span class="token operator">=</span> zcf<span class="token punctuation">.</span><span class="token function">getTerms</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="zcf-getzoeservice"><a href="#zcf-getzoeservice" class="header-anchor">#</a> zcf.getZoeService()</h2> <ul><li>Returns: <a href="/documentation/zoe/api/zoe.html">ZoeService</a></li></ul> <p>This is the only way to get the user-facing <a href="/documentation/zoe/api/zoe.html#zoe">Zoe Service API</a> to
the contract code as well.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Making an offer to another contract instance in the contract.</span>
<span class="token keyword">const</span> zoeService <span class="token operator">=</span> zcf<span class="token punctuation">.</span><span class="token function">getZoeService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">E</span><span class="token punctuation">(</span>zoeService<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>creatorInvitation<span class="token punctuation">,</span> proposal<span class="token punctuation">,</span> paymentKeywordRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-assertuniquekeyword-keyword"><a href="#zcf-assertuniquekeyword-keyword" class="header-anchor">#</a> zcf.assertUniqueKeyword(keyword)</h2> <ul><li><code>keyword</code> <code>{String}</code></li> <li>Returns: Undefined</li></ul> <p>Checks if a keyword is valid and not already used as a <code>brand</code> in this <code>instance</code> (i.e. unique)
and could be used as a new <code>brand</code> to make an <code>issuer</code>. Throws an appropriate error if it's not
a valid keyword, or is not unique.</p> <div class="language-js extra-class"><pre class="language-js"><code>zcf<span class="token punctuation">.</span><span class="token function">assertUniqueKeyword</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="zcf-reallocate-seatstagings"><a href="#zcf-reallocate-seatstagings" class="header-anchor">#</a> zcf.reallocate(seatStagings)</h2> <ul><li><code>seatStagings</code> <code>{SeatStaging[]}</code> (at least two)</li> <li>Returns: <code>{void}</code></li></ul> <p>The contract reallocates over <code>seatStagings</code>, which are
associations of <code>seats</code> with new <code>allocations</code> to be used in reallocation.
There must be at least two <code>seatStagings</code> in the array argument.</p> <p>The reallocation only succeeds if it:</p> <ol><li>Conserves rights (the specified <code>amounts</code> have the same total value as the
current total amount)</li> <li>Is 'offer-safe' for all parties
involved. Offer safety is checked at the staging step.</li></ol> <p>The reallocation is partial, only applying to <code>seats</code> associated
with the <code>seatStagings</code>. By induction, if rights conservation and
offer safety hold before, they hold after a safe reallocation.</p> <p>This is true even though we only re-validate for <code>seats</code> whose
<code>allocations</code> change. A reallocation can only effect offer safety for
those <code>seats</code>, and since rights are conserved for the change, overall
rights are unchanged.</p> <p><code>reallocate()</code> throws these errors:</p> <ul><li><code>reallocating must be done over two or more seats</code></li> <li><code>The seatStaging was not recognized</code></li> <li><code>The seatStaging was not recognized</code></li> <li><code>keyword must be unique</code></li> <li>If the total <code>amount</code> per <code>brand</code> is not equal to the total <code>amount</code> per <code>brand</code>
in the proposed reallocation. (no message)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>zcf<span class="token punctuation">.</span><span class="token function">reallocate</span><span class="token punctuation">(</span>
    seat<span class="token punctuation">.</span><span class="token function">stage</span><span class="token punctuation">(</span>seatAAllocation<span class="token punctuation">)</span><span class="token punctuation">,</span>
    seat<span class="token punctuation">.</span><span class="token function">stage</span><span class="token punctuation">(</span>seatBAllocation<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Agoric/documentation/edit/main/main/zoe/api/zoe-contract-facet.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/6/2020, 6:13:40 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/documentation/zoe/api/zoe.html" class="prev">
        Zoe
      </a></span> <span class="next"><a href="/documentation/zoe/api/zoe-helpers.html">
        ZoeHelpers
      </a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/documentation/assets/js/app.b94665ac.js" defer></script><script src="/documentation/assets/js/2.e3678fd8.js" defer></script><script src="/documentation/assets/js/41.2f3c677d.js" defer></script><script src="/documentation/assets/js/16.4354b4bb.js" defer></script>
  </body>
</html>
